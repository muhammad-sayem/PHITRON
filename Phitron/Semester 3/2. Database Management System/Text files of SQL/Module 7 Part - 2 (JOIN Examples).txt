-- QSTN 1: SHOW EMPLOYEES FIRST_NAME AND HIS/HER MANAGERS fIRST_NAME (SELF JOIN) -- 

SELECT M.FIRST_NAME, E.FIRST_NAME
FROM EMPLOYEES AS E
	JOIN EMPLOYEES AS M
    ON E.EMPLOYEE_ID = M.MANAGER_ID;

-- QSTN 2: EMON DEPARTMENT ER NAME SHOW KORTE HOBE JEKHANE KONO EMPLOYEE NEI --

SELECT DEPARTMENTS.DEPARTMENT_NAME, DEPARTMENTS.DEPARTMENT_ID
FROM DEPARTMENTS
	LEFT JOIN EMPLOYEES
    ON DEPARTMENTS.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID
WHERE EMPLOYEES.DEPARTMENT_ID IS NULL;

-- QSTN 3: SHOW FIRST_NAME, SALARY AND HE/SHE TAR DEPARTMENT ER AVERAGE SALARY THEKE KOTO KOM PAAY --

SELECT 
	EMPLOYEES.FIRST_NAME,
    EMPLOYEES.SALARY, 
    (SELECT AVG(SALARY) FROM EMPLOYEES WHERE DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID) - EMPLOYEES.SALARY
FROM EMPLOYEES
	JOIN DEPARTMENTS
    ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;
    
-- QSTN -4: SHOW DEPARTMENT_NAME WHERE THE MINIMUM SALARY IS GREATER THAN 5000 --

SELECT DEPARTMENT_NAME, MIN(SALARY), AVG(SALARY)
FROM EMPLOYEES
	JOIN DEPARTMENTS
		ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID
GROUP BY DEPARTMENT_NAME
HAVING MIN(SALARY) > 8000;

